table Dim_Date
	lineageTag: fbe6011e-9d94-49aa-a24a-1fcec4fc20ff

	column Date
		formatString: dd/mm/yy
		lineageTag: 417005f3-8af3-45cd-be08-9be6b3f12e9b
		summarizeBy: none
		isNameInferred
		sourceColumn: [Date]

		variation Variation
			isDefault
			relationship: b7be012b-f043-4698-a68b-90f3038670b2
			defaultHierarchy: LocalDateTable_6e490a31-a957-46f6-ab08-079221e1b34c.'Hiérarchie de dates'

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isCustom":true}

	column Afficher_12M_Glissants =
			
			VAR DerniereDate = CALCULATE(
			    MAX('Customer invoices'[date]),  -- <<< Prend la date max des données
			    REMOVEFILTERS('Customer invoices')
			)
			VAR Date12MoisAvant = EDATE(DerniereDate, -11)
			
			RETURN
			IF(
			    'Dim_Date'[Date] >= Date12MoisAvant && 'Dim_Date'[Date] <= DerniereDate,
			    1,
			    0
			)
		formatString: 0
		lineageTag: 5b120ce7-6328-423b-ad7d-d36d869b48aa
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column Year
		formatString: 0
		lineageTag: 401f0844-588b-48ce-b60e-9c0bdbc53ff0
		summarizeBy: sum
		isNameInferred
		sourceColumn: [Year]

		annotation SummarizationSetBy = Automatic

	column Quarter
		formatString: 0
		lineageTag: 9b0d4e67-dca3-4559-8eb6-903b87fdc9e6
		summarizeBy: sum
		isNameInferred
		sourceColumn: [Quarter]

		annotation SummarizationSetBy = Automatic

	column Month
		lineageTag: 69bc2449-19d2-4380-bc10-cffe2a5fda15
		summarizeBy: none
		isNameInferred
		sourceColumn: [Month]
		sortByColumn: FiscalMonthNum

		annotation SummarizationSetBy = Automatic

	column MonthNum
		formatString: 0
		lineageTag: 069ee29c-c3f5-44de-833b-cbbc4fe894f9
		summarizeBy: sum
		isNameInferred
		sourceColumn: [MonthNum]

		annotation SummarizationSetBy = Automatic

	column Year-Month
		lineageTag: a21eb657-e43b-4b2b-b113-45d5e9809af7
		summarizeBy: none
		isNameInferred
		sourceColumn: [Year-Month]
		sortByColumn: FiscalMonthNum

		annotation SummarizationSetBy = Automatic

	column 'Fiscal Year'
		lineageTag: bb598998-61b7-4b6a-b8ec-17cdf4d639fa
		summarizeBy: none
		isNameInferred
		sourceColumn: [Fiscal Year]

		annotation SummarizationSetBy = Automatic

	column DiffMonths
		formatString: 0
		lineageTag: a1173ffd-d3a6-4981-adb0-89ce7c2a7292
		summarizeBy: sum
		isNameInferred
		sourceColumn: [DiffMonths]

		annotation SummarizationSetBy = Automatic

	column FiscalMonthNum =
			
			IF( MONTH([Date]) >= 10, MONTH([Date]) - 9, MONTH([Date]) + 3 )
		formatString: 0
		lineageTag: d0822d7d-e0a2-492a-9969-1e3c44a0a8a4
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	partition Dim_Date = calculated
		mode: import
		source = ```
				
				ADDCOLUMNS(
				    CALENDAR(DATE(2021, 10, 1), DATE(2026, 09, 30)),
				    "Year", YEAR([Date]),
				    "Quarter", QUARTER([Date]),
				    "Month", FORMAT([Date], "mmm", "en-US"),
				    "MonthNum", MONTH([Date]),
				    "Year-Month", FORMAT([Date], "YY-MM"),
				    "Fiscal Year",
				        SWITCH(
				            TRUE(),
				            [Date] >= DATE(2021,10,1) && [Date] <= DATE(2022,9,30), "2022",
				            [Date] >= DATE(2022,10,1) && [Date] <= DATE(2023,9,30), "2023",
				            [Date] >= DATE(2023,10,1) && [Date] <= DATE(2024,9,30), "2024",
				            [Date] >= DATE(2024,10,1) && [Date] <= DATE(2025,9,30), "2025",
				            [Date] >= DATE(2025,10,1) && [Date] <= DATE(2026,9,30), "2026",
				            BLANK()
				        ),
				    "DiffMonths", DATEDIFF([Date], TODAY(), MONTH)
				)
				
				```

	annotation PBI_Id = 903eee4a8b814c918c00199c8a6d2770

