table 'Date–Period Bridge'
	lineageTag: 33372865-eccb-4323-85d6-cc8766a90264

	column Date
		formatString: General Date
		lineageTag: f5b01213-3e72-4597-8994-29b2ad8ccdcf
		summarizeBy: none
		isNameInferred
		sourceColumn: [Date]

		annotation SummarizationSetBy = Automatic

	column PeriodKey
		formatString: 0
		lineageTag: 11a08027-ae25-4bc4-89a2-41274279ef97
		summarizeBy: none
		isNameInferred
		sourceColumn: [PeriodKey]

		annotation SummarizationSetBy = Automatic

	partition 'Date–Period Bridge' = calculated
		mode: import
		source = ```
				
				VAR t = TODAY()
				
				// Exercice fiscal Oct→Sep
				VAR FYStart      = DATE( YEAR(t) - IF(MONTH(t) >= 10, 0, 1), 10, 1 )
				VAR FYEnd        = DATE( YEAR(FYStart) + 1, 9, 30 )
				VAR PrevFYStart  = EDATE(FYStart, -12)
				VAR PrevFYEnd    = FYStart - 1
				
				// Mois / Année calendaires
				VAR CurrMonthStart = DATE( YEAR(t), MONTH(t), 1 )
				VAR CurrMonthEnd   = EOMONTH(t, 0)
				VAR LastMonthEnd   = EOMONTH(t, -1)
				VAR LastMonthStart = DATE( YEAR(LastMonthEnd), MONTH(LastMonthEnd), 1 )
				VAR CurrYearStart  = DATE( YEAR(t), 1, 1 )
				VAR CurrYearEnd    = DATE( YEAR(t), 12, 31 )
				VAR LastYearStart  = DATE( YEAR(t) - 1, 1, 1 )
				VAR LastYearEnd    = DATE( YEAR(t) - 1, 12, 31 )
				
				RETURN
				UNION(
				    SELECTCOLUMNS(
				        FILTER(Dim_Date, Dim_Date[Date] >= FYStart && Dim_Date[Date] <= FYEnd),
				        "Date", Dim_Date[Date], "PeriodKey", 1
				    ),
				    SELECTCOLUMNS(
				        FILTER(Dim_Date, Dim_Date[Date] >= PrevFYStart && Dim_Date[Date] <= PrevFYEnd),
				        "Date", Dim_Date[Date], "PeriodKey", 2
				    ),
				    SELECTCOLUMNS(
				        FILTER(Dim_Date, Dim_Date[Date] >= CurrMonthStart && Dim_Date[Date] <= CurrMonthEnd),
				        "Date", Dim_Date[Date], "PeriodKey", 3
				    ),
				    SELECTCOLUMNS(
				        FILTER(Dim_Date, Dim_Date[Date] >= t - 6 && Dim_Date[Date] <= t),
				        "Date", Dim_Date[Date], "PeriodKey", 4
				    ),
				    SELECTCOLUMNS(
				        FILTER(Dim_Date, Dim_Date[Date] >= LastMonthStart && Dim_Date[Date] <= LastMonthEnd),
				        "Date", Dim_Date[Date], "PeriodKey", 5
				    ),
				    SELECTCOLUMNS(
				        FILTER(Dim_Date, Dim_Date[Date] >= CurrYearStart && Dim_Date[Date] <= CurrYearEnd),
				        "Date", Dim_Date[Date], "PeriodKey", 6
				    ),
				    SELECTCOLUMNS(
				        FILTER(Dim_Date, Dim_Date[Date] >= LastYearStart && Dim_Date[Date] <= LastYearEnd),
				        "Date", Dim_Date[Date], "PeriodKey", 7
				    )
				)
				
				```

	annotation PBI_Id = 4c202eca2fd94479a5221d2bbbc7b326

